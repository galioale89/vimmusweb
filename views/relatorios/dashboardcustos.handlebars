<style>
    table,
    td,
    tr,
    th {
        text-align: center;
    }

    td {
        font-weight: 700;
        font-size: 15px;
    }
    li {
        font-size: 16px;
        line-height: 18px;
    }
</style>
<div style="margin-top: 5px;padding-left:20px;padding-right:20px">

    <!-- Modal -->
    <div class='modal fade' id='partComponentes' tabindex="-1" aria-hidden="true">
        <div class='modal-dialog modal-xl'>
            <div class='modal-content'>
                <div class='modal-header'>
                    <h5 class="modal-title">Participação dos Componentes (Kit Gerador) por kW/p</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class='modal-body'>
                    <table align="center">
                        <tr>
                            <td>Módulos</td>
                            <td>Inversor</td>
                            <td>Estrutura</td>
                            <td>Cabos</td>
                            <td>Disjuntores</td>
                            <td>DPS</td>
                            <td>String Box</td>
                            <td>Outros</td>
                            <td>Total R$</td>
                        </tr>
                        <tr>
                            <td>R$ {{med_modequ}}</td>
                            <td>R$ {{med_invequ}}</td>
                            <td>R$ {{med_estequ}}</td>
                            <td>R$ {{med_cabequ}}</td>
                            <td>R$ {{med_disequ}}</td>
                            <td>R$ {{med_dpsequ}}</td>
                            <td>R$ {{med_sbxequ}}</td>
                            <td>R$ {{med_ocpequ}}</td>
                        </tr>
                        <td>
                            <div class="sessao-dash-total textoper" style="margin-left: 5px;">
                                {{per_modequ}}%
                            </div>
                        </td>
                        <td>
                            <div class="sessao-dash-total textoper" style="margin-left: 5px;">
                                {{per_invequ}}%
                            </div>
                        </td>
                        <td>
                            <div class="sessao-dash-total textoper" style="margin-left: 5px;">
                                {{per_estequ}}%
                            </div>
                        </td>
                        <td>
                            <div class="sessao-dash-total textoper" style="margin-left: 5px;">
                                {{per_cabequ}}%
                            </div>
                        </td>
                        <td>
                            <div class="sessao-dash-total textoper" style="margin-left: 5px;">
                                {{per_disequ}}%
                            </div>
                        </td>
                        <td>
                            <div class="sessao-dash-total textoper" style="margin-left: 5px;">
                                {{per_dpsequ}}%
                            </div>
                        </td>
                        <td>
                            <div class="sessao-dash-total textoper" style="margin-left: 5px;">
                                {{per_sbxequ}}%
                            </div>
                        </td>
                        <td>
                            <div class="sessao-dash-total textoper" style="margin-left: 5px;">
                                {{per_ocpequ}}%
                            </div>
                        </td>
                        <td>
                            <div class="sessao-dash textoper" style="margin-left: 5px;">
                                {{med_totequ}}
                            </div>
                        </td>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal -->

    <div class="row">
        <div class="col-md-2">
            <div class="contorno-titulo text-center" style="height: 100%;width: 100%;">
                <label class='col-form-label fw-bold' style="font-size: 20px; margin-left: 10%;">Visão Geral</label>
                <div class="text-center">
                    <label style="font-size: 18px;margin-left: 2%;">Projetos Realizados: </label><br>
                    <label style="font-size: 18px;margin-left: 2%;">{{numprj}}</label>
                </div>

                <div class='sessao-dash' style="margin-left: 3%;">
                    <li><label class='col-form-label col-form-label-sm' style="">kWp Instalados</label>
                    </li>
                    <li><label class='col-form-label col-form-label-sm' style="font-size: 25px;">{{soma_totkwp}}</label>
                    </li>
                </div>
                <div class='sessao-dash' style="margin-left: 3%;">
                    <li><label class='col-form-label col-form-label-sm' style="">R$ Projetos
                            Vendidos</label></li>
                    <li><label class='col-form-label col-form-label-sm' style="font-size: 25px;">R$
                            {{soma_totprj}}</label></li>
                </div>
                <div class='sessao-dash' style="margin-left: 3%;">
                    <label class='col-form-label col-form-label-sm' style="">Lucro Líquido</label></li>
                    <li><label class='col-form-label col-form-label-sm' style="font-size: 25px;">
                            {{per_totliq}} %</label></li>
                </div>
                <div class='sessao-dash' style="margin-left: 3%;">
                    <li><label class='col-form-label col-form-label-sm' style="">Dispêndio</label></li>
                    <li><label class='col-form-label col-form-label-sm' style="font-size: 25px;">
                            {{per_dispendio}} %</label></li>
                </div>
            </div>
        </div>
        <div class="col-md-3 mt-2 text-center">
            <li><label class='col-form-label fw-bold'>Participação dos Custos por kWp Faturado</label></li>
            <div class="row">
                <label class='col-form-label fw-bold text-center'>Custos Fixos e Variáveis</label>
                <div class="col-md-5 text-end">
                    <li style="">Projetista:</li>
                    <li style="">Art:</li>
                    <li style="">Gestão:</li>
                    <li style="">Instalação:</li>
                    <li style="">Administrativo:</li>
                    <li style="">Comissão:</li>
                    <li style="">Tributos:</li>
                    <li style="">Total:</li>
                </div>
                <div class="col-md-4 text-start">
                    <li style="">R$ {{medkwp_totpro}}</li>
                    <li style="">R$ {{medkwp_totart}}</li>
                    <li style="">R$ {{medkwp_totges}}</li>
                    <li style="">R$ {{medkwp_totint}}</li>
                    <li style="">R$ {{medkwp_totadm}}</li>
                    <li style="">R$ {{medkwp_totcom}}</li>
                    <li style="">R$ {{medkwp_tottrb}}</li>
                    <li style="">R$ {{medkwp_custoFix}}</li>
                </div>
                <div class="col-md-3 text-start">
                    <li style="">{{per_totpro}} %</li>
                    <li style="">{{per_totart}} %</li>
                    <li style="">{{per_totges}} %</li>
                    <li style="">{{per_totint}} %</li>
                    <li style="">{{per_totadm}} %</li>
                    <li style="">{{per_totcom}} %</li>
                    <li style="">{{per_tottrb}} %</li>
                    <li style="">{{per_totcus}} %</li>

                </div>
            </div>
            <div class="row">
                <label class='col-form-label fw-bold text-center'>Outros Custos Variáveis</label>
                <div class="col-md-5 text-end">
                    <li style="">Alimentação:</li>
                    <li style="">Deslocamento:</li>
                    <li style="">Total:</li>
                </div>
                <div class="col-md-4 text-start">
                    <li style="">R$ {{medkwp_totali}}</li>
                    <li style="">R$ {{medkwp_totdes}}</li>
                    <li style="">R$ {{medkwp_custoVar}}</li>
                </div>
                <div class="col-md-3 text-start">
                    <li style="">{{per_totali}} %</li>
                    <li style="">{{per_totdes}} %</li>
                    <li style="">{{per_totvar}} %</li>
                </div>
            </div>
            <div class="row">
                <label class='col-form-label fw-bold text-center'>Custos Variáveis Estruturais</label>
                <div class="col-md-5 text-end">
                    <li style="">Cercamento:</li>
                    <li style="">Central:</li>
                    <li style="">Postes:</li>
                    <li style="">Total:</li>
                </div>
                <div class="col-md-4 text-start">
                    <li style="">R$ {{medkwp_totcer}}</li>
                    <li style="">R$ {{medkwp_totcen}}</li>
                    <li style="">R$ {{medkwp_totpos}}</li>
                    <li style="">R$ {{medkwp_custoEst}}</li>
                </div>
                <div class="col-md-3 text-start">
                    <li style="">{{per_totcer}} %</li>
                    <li style="">{{per_totcen}} %</li>
                    <li style="">{{per_totpos}} %</li>
                    <li style="">{{per_totest}} %</li>
                </div>
            </div>
            <li class='text-center'><label class='col-form-label fw-bold'>Total Serviços: R$ {{soma_totser}}</label>
            </li>
        </div>
        <div class="col-md-7">
            <form method='post' action='/relatorios/filtradash'>
                <div class="row">
                    <div class="sessao-dash-titulo text-center" style="margin-bottom: 20px;margin-top: 20px;">
                        <label class='col-form-label fw-bold' style="color: white;">{{#if
                            mestitulo}}{{mestitulo}}{{ano}}{{else}}Tudo{{/if}}</label>
                    </div>

                    <div class="col-md-5 mb-3 text-end">
                        <label class='col-form-label fw-bold col-form-label-sm'>Selecione o mês e digite o ano:<label>
                    </div>
                    <div class="col-md-3">
                        <select class='form-select form-select-sm' name='messel'>
                            <option>Janeiro</option>
                            <option>Fevereiro</option>
                            <option>Março</option>
                            <option>Abril</option>
                            <option>Maio</option>
                            <option>Junho</option>
                            <option>Julho</option>
                            <option>Agosto</option>
                            <option>Setembro</option>
                            <option>Outubro</option>
                            <option>Novembro</option>
                            <option>Dezembro</option>
                            <option>Todos</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <input class='form-control form-control-sm' type='number' name='mesano' placeholder="Ano">
                    </div>
                    <div class="col-md-2">
                        <button type='submit' class='btn btn-primary btn-sm'>Filtrar</button>
                    </div>
                </div>
                <div style="height: 250px;padding-right: 5%;">
                    <input id='totfat' type="hidden" value='{{soma_totfat}}'>
                    <input id='totliq' type="hidden" value='{{soma_totliq}}'>
                    <input id='totkit' type="hidden" value='{{soma_totkit}}'>
                    <input id='totcom' type="hidden" value='{{soma_totcom}}'>
                    <input id='totcop' type="hidden" value='{{soma_totcop}}'>
                    <input id='totadm' type="hidden" value='{{soma_totadm}}'>
                    <input id='tottrb' type="hidden" value='{{soma_tottrb}}'>
                    <canvas id='chartTot'></canvas>
                </div>
            </form>
            <div class="row mt-2">
                <div class='row text-center'>
                    <div class="col-md-3 sessao-dash-kit">
                        <label>Equipamento</label><br>
                        <label class='col-form-label fw-bold' style="font-size: 20px">{{per_kitfat}} %</label>
                    </div>
                    <div class="col-md-2 sessao-dash-kit">
                        <label>Comissão</label>
                        <label class='col-form-label fw-bold' style="font-size: 20px">{{per_comfat}} %</label>
                    </div>
                    <div class="col-md-2 sessao-dash-kit">
                        <label>Custos</label>
                        <label class='col-form-label fw-bold' style="font-size: 20px">{{per_cusfat}} %</label>
                    </div>
                    <div class="col-md-3 sessao-dash-kit">
                        <label>Administrativo</label>
                        <label class='col-form-label fw-bold' style="font-size: 20px">{{per_desfat}} %</label>
                    </div>
                    <div class="col-md-2 sessao-dash-kit">
                        <label>Tributos</label>
                        <label class='col-form-label fw-bold' style="font-size: 20px">{{per_trbfat}} %</label>
                    </div>
                </div>
            </div>
            <div class="row mt-1 text-center">
                <label class='col-form-label fw-bold'>Análise dos Resultados</label>
                <div class="btn-group col-12 gap-2" style="width: 97%;">
                    <a class='btn btn-sm btn-primary' class='col-form-label fw-bold' data-bs-toggle="modal"
                        data-bs-target="#partComponentes"
                        style="cursor: pointer;text-decoration: none;color: white;">Equipamento</a>
                    <a href='/relatorios/dashboardcustos' class='btn btn-sm btn-primary'>Geral</a>
                    <a href='/relatorios/dashboardcustoscomkit' class='btn btn-sm btn-primary'>Com Kit</a>
                    <a href='/relatorios/dashboardcustossemkit' class='btn btn-sm btn-primary'>Sem Kit</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    var soma_totfat = document.getElementById('totfat')
    var soma_totcop = document.getElementById('totcop')
    var soma_totkit = document.getElementById('totkit')
    var soma_totcom = document.getElementById('totcom')
    var soma_totliq = document.getElementById('totliq')
    var soma_totadm = document.getElementById('totadm')
    var soma_tottrb = document.getElementById('tottrb')
    var ctxTot = document.getElementById('chartTot').getContext('2d')
    var chartTot = new Chart(ctxTot, {
        type: 'bar',
        data: {
            labels: ['Faturado', 'Equipamentos', 'Comissão', 'Custos', 'Administrativo', 'Tributos', 'Lucro Liquido'],
            datasets: [{
                data: [soma_totfat.value, soma_totkit.value, soma_totcom.value, soma_totcop.value, soma_totadm.value, soma_tottrb.value, soma_totliq.value],
                backgroundColor: [
                    'rgba(41, 8, 159, 0.5)',
                    'rgba(249, 240, 71, 0.5)',
                    'rgba(255, 161, 8, 0.5)',
                    'rgba(194, 189, 188, 0.5)',
                    'rgba(194, 189, 188, 0.5)',
                    'rgba(255, 49, 53, 0.5)',
                    'rgb(32, 255, 62, 0.5)'
                ],

                borderColor: [
                    'rgba(41, 8, 159, 1)',
                    'rgba(249,240,71, 1)',
                    'rgba(255, 161, 8, 1)',
                    'rgba(194, 189, 188, 1)',
                    'rgba(194, 189, 188, 1)',
                    'rgba(255, 49, 53, 1)',
                    'rgb(32, 255, 62, 1)'
                ],
            }]
        },
        options: {
            maintainAspectRatio: false,
            responsive: true,
            scales: {
                yAxes: [{
                    scaleLabel: {
                        display: true,
                        labelString: 'Resultados'
                    },
                    ticks: {
                        min: 0,
                    },
                }],
            },
            legend: {
                labels: {
                    boxWidth: 0,
                },
                display: false,
            },
        }
    })

    var prjjan = document.getElementById('prjjan')
    var prjfev = document.getElementById('prjfev')
    var prjmar = document.getElementById('prjmar')
    var prjabr = document.getElementById('prjabr')
    var prjmai = document.getElementById('prjmai')
    var prjjun = document.getElementById('prjjun')
    var prjjul = document.getElementById('prjjul')
    var prjago = document.getElementById('prjago')
    var prjset = document.getElementById('prjset')
    var prjout = document.getElementById('prjout')
    var prjnov = document.getElementById('prjnov')
    var prjdez = document.getElementById('prjdez')

    var ctxPrj = document.getElementById('chartPrj').getContext('2d')
    var chartPrj = new Chart(ctxPrj, {
        type: 'line',
        data: {
            labels: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
            datasets: [{
                data: [prjjan.value, prjfev.value, prjmar.value, prjabr.value, prjmai.value, prjjun.value, prjjul.value, prjago.value, prjset.value, prjout.value, prjnov.value, prjdez.value],
                backgroundColor: ['rgb(79, 99, 140)'],
                borderColor: ['rgb(79, 99, 140)']
            }]
        },
        options: {
            maintainAspectRatio: false,
            responsive: true,
            scales: {
                yAxes: [{
                    scaleLabel: {
                        display: true,
                        labelString: 'Quantidade de Projetos'
                    },
                    ticks: {
                        min: 0,
                    },
                }],
            },
            legend: {
                labels: {
                    boxWidth: 0,
                },
                display: false,
            },
        }
    })
</script>